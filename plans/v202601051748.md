# `make_latex_model` Skill å¼€å‘è®¡åˆ’

**åˆ›å»ºæ—¶é—´**ï¼š2026-01-05 17:48
**çŠ¶æ€**ï¼šå¾…å®¡æŸ¥
**ç‰ˆæœ¬**ï¼šv1.0.0

---

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### æŠ€èƒ½åç§°
`make_latex_model`

### æ ¸å¿ƒç›®æ ‡
åŸºäºæœ€æ–° Word æ¨¡æ¿é«˜ä¿çœŸä¼˜åŒ–ç°æœ‰çš„ LaTeX æ¨¡æ¿ï¼ˆ[main.tex](projects/NSFC_Young/main.tex) å’Œ [@config.tex](projects/NSFC_Young/extraTex/@config.tex)ï¼‰ï¼Œç¡®ä¿æ¸²æŸ“çš„ PDF ä¸ Word ç‰ˆæ‰“å°çš„ PDF åœ¨**æ ‡é¢˜æ ·å¼ä¸Šå®Œå…¨ä¸€è‡´**ã€‚

### ä¿çœŸåº¦è¦æ±‚
âš ï¸ **æé«˜** â€” å›½è‡ªç„¶åŸºé‡‘å§”å¯¹æ ¼å¼è¦æ±‚éå¸¸ä¸¥æ ¼ï¼Œæ ·å¼å·®å¼‚å¯èƒ½å¯¼è‡´å½¢å¼å®¡æŸ¥ä¸é€šè¿‡ã€‚

---

## ğŸ“ ç›®å½•ç»“æ„

```
skills/make_latex_model/
â”œâ”€â”€ SKILL.md              # æŠ€èƒ½ä¸»æ–‡æ¡£ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ config.yaml           # æŠ€èƒ½é…ç½®ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ README.md             # æŠ€èƒ½è¯´æ˜ï¼ˆå¯é€‰ï¼‰
â””â”€â”€ scripts/              # è¾…åŠ©è„šæœ¬ï¼ˆå¯é€‰ï¼‰
```

---

## ğŸ“ SKILL.md å®Œæ•´å†…å®¹

```markdown
---
name: make_latex_model
version: 1.0.0
description: åŸºäº NSFC æœ€æ–° Word æ¨¡æ¿é«˜ä¿çœŸä¼˜åŒ– LaTeX æ¨¡æ¿ï¼ˆmain.tex + @config.texï¼‰
category: normal
---

# NSFC LaTeX æ¨¡æ¿é«˜ä¿çœŸä¼˜åŒ–å™¨

## 0.5) æ·±åº¦å‚è€ƒ
- æœ¬é¡¹ç›®çš„ [CLAUDE.md](../CLAUDE.md) å’Œ [skills/README.md](skills/README.md) è§„èŒƒ
- ç°æœ‰æŸä¸ªprojectçš„ main.tex å’Œ @config.tex çš„æ ·å¼å®šä¹‰æ¨¡å¼

## 0) æ ¸å¿ƒç›®æ ‡
ç¡®ä¿ LaTeX æ¸²æŸ“çš„ PDF ä¸ Word ç‰ˆæ‰“å°çš„ PDFåœ¨**æ ‡é¢˜æ ·å¼ä¸Šå®Œå…¨ä¸€è‡´**ï¼š
- æ ‡é¢˜å±‚çº§æ ¼å¼ï¼ˆä¸€çº§ã€äºŒçº§ã€ä¸‰çº§ã€å››çº§ï¼‰
- å­—ä½“ï¼ˆä¸­æ–‡æ¥·ä½“ + è‹±æ–‡ Times New Romanï¼‰
- å­—å·ï¼ˆä¸‰å·ã€å››å·ã€å°å››ç­‰ï¼‰
- é¢œè‰²ï¼ˆMsBlue RGB 0,112,192ï¼‰
- é—´è·ï¼ˆè¡Œè·ã€æ®µå‰æ®µåã€ç¼©è¿›ï¼‰
- åˆ—è¡¨æ ·å¼ï¼ˆç¼–å·æ ¼å¼ã€ç¼©è¿›ï¼‰
- é¡µé¢è®¾ç½®ï¼ˆè¾¹è·ã€ç‰ˆå¿ƒï¼‰

## 1) è§¦å‘æ¡ä»¶
ç”¨æˆ·åœ¨ä»¥ä¸‹åœºæ™¯è§¦å‘æœ¬æŠ€èƒ½ï¼š
- NSFC å‘å¸ƒäº†æ–°çš„å¹´åº¦ Word æ¨¡æ¿ï¼ˆå¦‚ 2026 å¹´ç‰ˆï¼‰
- å½“å‰ LaTeX æ¨¡æ¿ä¸ Word æ¨¡æ¿å­˜åœ¨æ˜æ˜¾æ ·å¼å·®å¼‚
- ç”¨æˆ·ä¸»åŠ¨è¦æ±‚"å¯¹é½ Word æ ·å¼"ã€"æ›´æ–°æ¨¡æ¿æ ¼å¼"

## 2) è¾“å…¥å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|------|------|------|------|
| `project` | string | æ˜¯ | é¡¹ç›®åç§°ï¼ˆå¦‚ `NSFC_Young`ã€`NSFC_General`ï¼‰ |
| `word_template_year` | string | æ˜¯ | Word æ¨¡æ¿å¹´ä»½ï¼ˆå¦‚ `2026`ï¼‰ |
| `optimization_level` | string | å¦ | ä¼˜åŒ–çº§åˆ«ï¼š`minimal`ï¼ˆæœ€å°æ”¹åŠ¨ï¼‰\|`moderate`ï¼ˆä¸­ç­‰ï¼‰\|`thorough`ï¼ˆå½»åº•ï¼‰ï¼Œé»˜è®¤ `moderate` |
| `dry_run` | boolean | å¦ | é¢„è§ˆæ¨¡å¼ï¼Œä¸å®é™…ä¿®æ”¹æ–‡ä»¶ï¼Œé»˜è®¤ `false` |

## 3) æ‰§è¡Œæµç¨‹

### æ­¥éª¤ 1ï¼šç†è§£ç°çŠ¶ï¼ˆæ·±åº¦é˜…è¯»ï¼‰
1. è¯»å– `projects/{project}/main.tex`ï¼Œåˆ†æï¼š
   - æ–‡æ¡£ç±»å£°æ˜ï¼ˆdocumentclassï¼‰
   - ç« èŠ‚ç»“æ„ï¼ˆsectionã€subsection ç­‰ï¼‰
   - ç‰¹æ®Šæ ¼å¼å‘½ä»¤ï¼ˆ\hspaceã€\vskip ç­‰ï¼‰
2. è¯»å– `projects/{project}/extraTex/@config.tex`ï¼Œåˆ†æï¼š
   - å®åŒ…åŠ è½½
   - é¡µé¢è®¾ç½®ï¼ˆgeometryï¼‰
   - é¢œè‰²å®šä¹‰ï¼ˆdefinecolorï¼‰
   - å­—ä½“è®¾ç½®ï¼ˆfontspecã€xeCJKï¼‰
   - å­—å·ç³»ç»Ÿï¼ˆnewcommand å­—å·å‘½ä»¤ï¼‰
   - æ ‡é¢˜æ ¼å¼ï¼ˆtitlesec å®šåˆ¶ï¼‰
   - åˆ—è¡¨æ ·å¼ï¼ˆenumitem é…ç½®ï¼‰

### æ­¥éª¤ 2ï¼šåˆ†æ Word æ¨¡æ¿
1. å®šä½ `projects/{project}/template/{word_template_year}å¹´æœ€æ–°wordæ¨¡æ¿-*.doc`
2. âš ï¸ ç”±äº .doc/.docx æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œé‡‡ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š
   - ä¼˜å…ˆæŸ¥çœ‹åŒå¹´åº¦çš„ .doc/.docx ç‰ˆæœ¬ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
   - å‚è€ƒ `projects/{project}/template/` ä¸‹çš„å†å²æ¨¡æ¿å¯¹æ¯”å˜åŒ–
   - ç”¨æˆ·æ‰‹åŠ¨æä¾› Word æ ·å¼ä¿¡æ¯ï¼ˆæˆªå›¾ã€æè¿°ï¼‰
3. æå–å…³é”®æ ·å¼è¦ç´ ï¼š
   - ä¸€çº§æ ‡é¢˜ï¼šå­—å·ã€å­—ä½“ã€é¢œè‰²ã€åŠ ç²—ã€ç¼©è¿›
   - äºŒçº§æ ‡é¢˜ï¼šåŒä¸Š
   - ä¸‰çº§æ ‡é¢˜ï¼šç¼–å·æ ¼å¼ï¼ˆå¦‚ 1.1ã€1.2ï¼‰ã€ç¼©è¿›
   - å››çº§æ ‡é¢˜ï¼šç¼–å·æ ¼å¼ï¼ˆå¦‚ï¼ˆ1ï¼‰ï¼‰
   - æ­£æ–‡ï¼šå­—å·ã€è¡Œè·ã€é¦–è¡Œç¼©è¿›
   - åˆ—è¡¨ï¼šç¼–å·æ ¼å¼ã€ç¼©è¿›ã€é—´è·

### æ­¥éª¤ 3ï¼šå·®å¼‚åˆ†æä¸ä¼˜åŒ–ç­–ç•¥
1. **å¯¹æ¯”å½“å‰ LaTeX æ ·å¼ä¸ Word æ¨¡æ¿**ï¼Œè¯†åˆ«å·®å¼‚ï¼š
   - å­—å·å·®å¼‚ï¼ˆå¦‚ 14pt vs 15ptï¼‰
   - é¢œè‰²å·®å¼‚ï¼ˆMsBlue æ˜¯å¦å‡†ç¡®ï¼‰
   - é—´è·å·®å¼‚ï¼ˆè¡Œè·ã€æ®µå‰æ®µåï¼‰
   - ç¼–å·æ ¼å¼å·®å¼‚ï¼ˆ1.1 vs 1.1.ï¼‰
2. **æ ¹æ® optimization_level ç¡®å®šä¿®æ”¹ç­–ç•¥**ï¼š
   - `minimal`ï¼šä»…ä¿®æ”¹æ˜æ˜¾é”™è¯¯çš„æ ·å¼ï¼ˆå¦‚é¢œè‰²å€¼é”™è¯¯ï¼‰
   - `moderate`ï¼ˆé»˜è®¤ï¼‰ï¼šè°ƒæ•´ä¸ Word ä¸ä¸€è‡´çš„æ ·å¼ï¼Œä¿æŒç»“æ„ç¨³å®š
   - `thorough`ï¼šé‡æ„æ ·å¼ç³»ç»Ÿï¼Œå®ç°æœ€å¤§ä¿çœŸåº¦

### æ­¥éª¤ 4ï¼šè½»é‡çº§ä¿®æ”¹åŸåˆ™
1. **ä¼˜å…ˆè°ƒæ•´å‚æ•°ï¼Œä¸é‡æ„ç»“æ„**ï¼š
   - è°ƒæ•´ `\titleformat` ä¸­çš„å­—å·ã€é¢œè‰²ã€é—´è·å‚æ•°
   - è°ƒæ•´ `\geometry` ä¸­çš„è¾¹è·å€¼
   - è°ƒæ•´ `\newcommand` å­—å·å®šä¹‰ä¸­çš„ pt å€¼
2. **ä¿ç•™è€æ ·å¼çš„ç¨³å®šæ€§**ï¼š
   - ä¸ä¿®æ”¹å®åŒ…åŠ è½½é¡ºåº
   - ä¸åˆ é™¤å·²æœ‰çš„è‡ªå®šä¹‰å‘½ä»¤
   - ä¸æ”¹å˜æ¡ä»¶åˆ¤æ–­ç»“æ„ï¼ˆå¦‚ `\ifwindows`ï¼‰
3. **å¢é‡æ·»åŠ æ–°æ ·å¼**ï¼ˆå¦‚æœ‰å¿…è¦ï¼‰ï¼š
   - æ–°å¢ `\newcommand` è€Œéä¿®æ”¹ç°æœ‰å‘½ä»¤
   - ä½¿ç”¨æ³¨é‡Šæ ‡è®°æ–°å¢å†…å®¹ï¼š`% 2026å¹´æ¨¡æ¿æ–°å¢`

### æ­¥éª¤ 5ï¼šæ‰§è¡Œä¿®æ”¹
1. **ä¿®æ”¹ @config.tex**ï¼ˆä¼˜å…ˆï¼‰ï¼š
   - è°ƒæ•´é¢œè‰²å®šä¹‰
   - è°ƒæ•´å­—å·ç³»ç»Ÿ
   - è°ƒæ•´æ ‡é¢˜æ ¼å¼ï¼ˆtitlesecï¼‰
   - è°ƒæ•´åˆ—è¡¨æ ·å¼
2. **ä¿®æ”¹ main.tex**ï¼ˆè°¨æ…ï¼‰ï¼š
   - ä»…å½“ Word æ¨¡æ¿çš„ç« èŠ‚ç»“æ„å˜åŒ–æ—¶æ‰è°ƒæ•´
   - ä¸»è¦è°ƒæ•´ `\section`ã€`\subsection` ä¸­çš„æ ¼å¼å‘½ä»¤
   - è°ƒæ•´ç‰¹æ®Šé—´è·ï¼ˆ\hspaceã€\vskipï¼‰

### æ­¥éª¤ 6ï¼šéªŒè¯ä¸è¿­ä»£
1. ç¼–è¯‘æ£€æŸ¥ï¼š
   ```bash
   cd projects/{project}
   xelatex -interaction=nonstopmode main.tex
   ```
2. PDF å¯¹æ¯”éªŒè¯ï¼š
   - ç”Ÿæˆçš„ PDF ä¸ Word æ‰“å°çš„ PDF é€é¡µå¯¹æ¯”
   - é‡ç‚¹å…³æ³¨æ ‡é¢˜æ ·å¼çš„ä¸€è‡´æ€§
3. å¿…è¦æ—¶è¿­ä»£ä¼˜åŒ–ï¼ˆæœ€å¤š 3 è½®ï¼‰

## 4) è¾“å‡ºè§„èŒƒ

### 4.1 ä¿®æ”¹æ‘˜è¦
Markdown æ ¼å¼çš„å˜æ›´æŠ¥å‘Šï¼ŒåŒ…å«ï¼š
- ä¿®æ”¹çš„æ–‡ä»¶åˆ—è¡¨
- æ¯ä¸ªä¿®æ”¹çš„è¯¦ç»†è¯´æ˜ï¼ˆä¿®æ”¹å‰ vs ä¿®æ”¹åï¼‰
- ä¼˜åŒ–ç†ç”±ï¼ˆåŸºäº Word æ¨¡æ¿çš„å“ªä¸ªç‰¹å¾ï¼‰

### 4.2 ä»£ç å˜æ›´
ä½¿ç”¨ Edit å·¥å…·è¿›è¡Œç²¾ç¡®ä¿®æ”¹ï¼Œä¿ç•™ï¼š
- åŸæœ‰æ³¨é‡Š
- ä»£ç é£æ ¼
- æ¡ä»¶åˆ¤æ–­ç»“æ„

### 4.3 éªŒè¯æ¸…å•
- [ ] ç¼–è¯‘æ— é”™è¯¯å’Œè­¦å‘Š
- [ ] PDF ä¸ Word æ¨¡æ¿æ ‡é¢˜æ ·å¼ä¸€è‡´
- [ ] é¡µè¾¹è·ä¸€è‡´
- [ ] å­—ä½“åŠ è½½æ­£å¸¸ï¼ˆè·¨å¹³å°ï¼‰
- [ ] å‚è€ƒæ–‡çŒ®æ ·å¼æ­£ç¡®
- [ ] è¡¨æ ¼å’Œå›¾ç‰‡ä½ç½®æ­£ç¡®

## 5) æ ¸å¿ƒåŸåˆ™ï¼ˆåº•çº¿ï¼‰

### 5.1 è½»é‡çº§ä¿®æ”¹ä¼˜å…ˆ
- âœ… è°ƒæ•´å‚æ•°å€¼ï¼ˆå­—å· pt å€¼ã€é¢œè‰² RGB å€¼ã€é—´è· em/cm å€¼ï¼‰
- âœ… æ–°å¢è‡ªå®šä¹‰å‘½ä»¤
- âŒ åˆ é™¤æˆ–é‡å‘½åç°æœ‰å‘½ä»¤
- âŒ æ”¹å˜å®åŒ…åŠ è½½é¡ºåº
- âŒ é‡æ„æ¡ä»¶åˆ¤æ–­ç»“æ„

### 5.2 ä¿çœŸåº¦ä¸ç¨³å®šæ€§å¹³è¡¡
- **è¿‡åº¦å¼€å‘çš„é£é™©**ï¼šå¼•å…¥ bugã€ç ´åå·²æœ‰åŠŸèƒ½ã€å¢åŠ ç»´æŠ¤æˆæœ¬
- **å¼€å‘ä¸è¶³çš„é£é™©**ï¼šæ ·å¼ä¸ä¸€è‡´ã€ä¸ç¬¦åˆåŸºé‡‘å§”è¦æ±‚
- **å¹³è¡¡ç­–ç•¥**ï¼š
  - é»˜è®¤ä½¿ç”¨ `moderate` çº§åˆ«
  - ä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨ `thorough` çº§åˆ«
  - ä¿ç•™è€æ ·å¼çš„æ ¸å¿ƒæ¶æ„

### 5.3 è·¨å¹³å°å…¼å®¹æ€§
- ä¿ç•™ `\ifwindows` æ¡ä»¶åˆ¤æ–­
- ç¡®ä¿ Mac/Windows/Linux éƒ½èƒ½æ­£ç¡®ç¼–è¯‘
- å¤–æŒ‚å­—ä½“è·¯å¾„ä¿æŒä¸å˜ï¼ˆ`./fonts/`ï¼‰

## 6) éªŒè¯æ¸…å•ï¼ˆå®Œæˆåè‡ªæ£€ï¼‰

- [ ] **ç¼–è¯‘æ£€æŸ¥**ï¼š`xelatex -> bibtex -> xelatex -> xelatex` æ— é”™è¯¯
- [ ] **æ ·å¼ä¸€è‡´æ€§**ï¼šæ ‡é¢˜å±‚çº§ã€å­—ä½“ã€å­—å·ã€é¢œè‰²ä¸ Word æ¨¡æ¿ä¸€è‡´
- [ ] **é¡µé¢è®¾ç½®**ï¼šè¾¹è·ã€è¡Œè·ã€ç‰ˆå¿ƒä¸ Word æ¨¡æ¿ä¸€è‡´
- [ ] **è·¨å¹³å°**ï¼šåœ¨è‡³å°‘ä¸¤ä¸ªæ“ä½œç³»ç»Ÿä¸ŠéªŒè¯ç¼–è¯‘
- [ ] **å‘åå…¼å®¹**ï¼šè€ç”¨æˆ·çš„å†…å®¹æ–‡ä»¶ï¼ˆextraTex/*.texï¼‰æ— éœ€ä¿®æ”¹å³å¯ä½¿ç”¨
- [ ] **æ–‡æ¡£æ›´æ–°**ï¼šå¦‚æœ‰æ–°å¢å‘½ä»¤æˆ–é…ç½®ï¼Œåœ¨ @config.tex é¡¶éƒ¨æ·»åŠ æ³¨é‡Šè¯´æ˜

## 7) å¸¸è§é—®é¢˜

### Q1: Word æ¨¡æ¿æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œå¦‚ä½•å‡†ç¡®æå–æ ·å¼ï¼Ÿ
A: é‡‡ç”¨å¤šç­–ç•¥ï¼š
1. ä¼˜å…ˆä½¿ç”¨ .docx ç‰ˆæœ¬ï¼ˆå¯ä»¥ç”¨ Python çš„ `python-docx` åº“è§£æï¼‰
2. å¯¹æ¯”å†å²æ¨¡æ¿çš„å˜åŒ–è¶‹åŠ¿
3. ç”¨æˆ·æ‰‹åŠ¨æä¾›æ ·å¼ä¿¡æ¯ï¼ˆæˆªå›¾ã€æµ‹é‡å€¼ï¼‰

### Q2: ä¿®æ”¹åè€ç”¨æˆ·çš„æ¨¡æ¿è¿˜èƒ½ç”¨å—ï¼Ÿ
A: èƒ½ã€‚æœ¬ skill ä»…ä¿®æ”¹æ ·å¼å®šä¹‰ï¼ˆ@config.tex å’Œ main.texï¼‰ï¼Œä¸æ”¹å˜å†…å®¹æ–‡ä»¶çš„æ¥å£ã€‚

### Q3: å¦‚ä½•åˆ¤æ–­ä¼˜åŒ–æ˜¯å¦"è¿‡åº¦"ï¼Ÿ
A: å‚è€ƒä»¥ä¸‹æ ‡å‡†ï¼š
- âœ… å‚æ•°è°ƒä¼˜ï¼ˆå¦‚ 14pt â†’ 15ptï¼‰ï¼šåˆç†
- âœ… æ–°å¢å‘½ä»¤ï¼šåˆç†
- âš ï¸ åˆ é™¤å‘½ä»¤ï¼šéœ€è°¨æ…ï¼Œç¡®ä¿æ— å¼•ç”¨
- âŒ é‡æ„æ ¸å¿ƒæ¶æ„ï¼šè¿‡åº¦

### Q4: å¦‚ä½•å¤„ç† Word æ¨¡æ¿ä¸­çš„æ–°ç« èŠ‚ï¼Ÿ
A:
1. åœ¨ main.tex ä¸­æ–°å¢å¯¹åº”çš„ `\section` æˆ– `\subsection`
2. åˆ›å»ºå¯¹åº”çš„ extraTex/*.tex å†…å®¹æ–‡ä»¶
3. åœ¨ @config.tex ä¸­æ·»åŠ å¿…è¦çš„æ ·å¼å®šä¹‰ï¼ˆå¦‚éœ€è¦ï¼‰

## 8) ç‰ˆæœ¬å†å²
- v1.0.0 (2026-01-05)ï¼šåˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒ NSFC_Young é¡¹ç›®çš„ 2026 å¹´æ¨¡æ¿å¯¹é½
```

---

## âš™ï¸ config.yaml å®Œæ•´å†…å®¹

```yaml
# ================================
# make_latex_model æŠ€èƒ½é…ç½®æ–‡ä»¶
# ================================

skill_info:
  name: make_latex_model
  version: 1.0.0
  description: åŸºäº NSFC æœ€æ–° Word æ¨¡æ¿é«˜ä¿çœŸä¼˜åŒ– LaTeX æ¨¡æ¿
  category: normal

# ================================
# è¾“å…¥å‚æ•°å®šä¹‰
# ================================
parameters:
  project:
    type: string
    required: true
    description: é¡¹ç›®åç§°ï¼ˆNSFC_Youngã€NSFC_Generalã€NSFC_Localï¼‰
    allowed_values:
      - NSFC_Young
      - NSFC_General
      - NSFC_Local
    default: NSFC_Young

  word_template_year:
    type: string
    required: true
    description: Word æ¨¡æ¿å¹´ä»½
    pattern: "^\\d{4}$"
    default: "2026"

  optimization_level:
    type: string
    required: false
    description: ä¼˜åŒ–çº§åˆ«
    allowed_values:
      - minimal      # æœ€å°æ”¹åŠ¨ï¼šä»…ä¿®å¤æ˜æ˜¾é”™è¯¯
      - moderate     # ä¸­ç­‰ä¼˜åŒ–ï¼šè°ƒæ•´ä¸ä¸€è‡´çš„æ ·å¼ï¼ˆé»˜è®¤ï¼‰
      - thorough     # å½»åº•é‡æ„ï¼šæœ€å¤§ä¿çœŸåº¦
    default: moderate

  dry_run:
    type: boolean
    required: false
    description: é¢„è§ˆæ¨¡å¼ï¼Œä¸å®é™…ä¿®æ”¹æ–‡ä»¶
    default: false

# ================================
# æ–‡ä»¶è·¯å¾„é…ç½®
# ================================
paths:
  projects_root: "./projects"
  templates_dir: "template"
  main_tex: "main.tex"
  config_tex: "extraTex/@config.tex"
  extratex_dir: "extraTex"
  fonts_dir: "fonts"
  figures_dir: "figures"

# ================================
# æ ·å¼å‚è€ƒåŸºå‡†ï¼ˆ2026å¹´Wordæ¨¡æ¿ï¼‰
# ================================
style_reference:
  # é¡µé¢è®¾ç½®
  page:
    margin_left: "3.20cm"
    margin_right: "3.14cm"
    margin_top: "2.54cm"
    margin_bottom: "2.54cm"
    line_spacing: 1.5

  # é¢œè‰²ç³»ç»Ÿ
  colors:
    MsBlue: "RGB 0,112,192"    # Word é£æ ¼è“è‰²
    header_color: "RGB 0,0,0"
    footer_color: "RGB 0,0,0"

  # å­—ä½“ç³»ç»Ÿ
  fonts:
    chinese_main: "KaiTi"       # ä¸­æ–‡æ¥·ä½“
    english_main: "Times New Roman"
    fake_bold_factor: 2.5

  # å­—å·ç³»ç»Ÿï¼ˆå•ä½ï¼šptï¼‰
  font_sizes:
    chuhao: 42
    xiaochuhao: 36
    yihao: 26
    erhao: 22
    xiaoerhao: 18
    sanhao: 16
    sihao: 14
    xiaosihao: 12
    wuhao: 10.5

  # æ ‡é¢˜æ ·å¼
  headings:
    section:
      font_size: 14        # å››å·
      font_weight: bold
      color: MsBlue
      indent: "1.45em"
      spacing_before: 0
      spacing_after: 0

    subsection:
      font_size: 14        # å››å·
      font_weight: normal
      color: MsBlue
      indent: "1.45em"
      line_spacing: 1.0

    subsubsection:
      font_size: 13.5
      font_weight: bold
      color: MsBlue
      numbered: true       # ç¼–å·æ ¼å¼ï¼š1.1, 1.2
      indent: "1.1em"
      sep: "0.5em"

    subsubsubsection:
      font_weight: bold
      numbered: true       # ç¼–å·æ ¼å¼ï¼šï¼ˆ1ï¼‰
      indent: "1em"
      sep: "0.5pt"

  # åˆ—è¡¨æ ·å¼
  lists:
    enumerate:
      label_format: "ï¼ˆ\\arabic*ï¼‰"
      color: MsBlue
      font_weight: bold
      left_margin: 0
      item_indent: "4em"
      item_sep: 0
      label_sep: "0.1pt"
      parsep: 0
      topsep: 0

# ================================
# ä¼˜åŒ–ç­–ç•¥é…ç½®
# ================================
optimization_strategies:
  minimal:
    description: "æœ€å°æ”¹åŠ¨ï¼šä»…ä¿®å¤æ˜æ˜¾é”™è¯¯"
    actions:
      - fix_color_values
      - fix_critical_font_sizes
      - fix_page_margins

  moderate:
    description: "ä¸­ç­‰ä¼˜åŒ–ï¼šè°ƒæ•´ä¸ä¸€è‡´çš„æ ·å¼ï¼ˆé»˜è®¤ï¼‰"
    actions:
      - fix_color_values
      - fix_font_sizes
      - fix_page_margins
      - adjust_spacing
      - align_numbering_format

  thorough:
    description: "å½»åº•é‡æ„ï¼šæœ€å¤§ä¿çœŸåº¦"
    actions:
      - complete_style_overhaul
      - refactor_title_formatting
      - optimize_list_styles
      - cross_platform_validation

# ================================
# ç¼–è¯‘é…ç½®
# ================================
compile_config:
  engine: xelatex
  interaction_mode: nonstopmode
  max_runs: 4
  sequence:
    - xelatex
    - bibtex
    - xelatex
    - xelatex

# ================================
# éªŒè¯è§„åˆ™
# ================================
validation:
  max_iterations: 3
  required_checks:
    - compilation_success
    - no_warnings
    - style_consistency
    - cross_platform_compatibility
  tolerance:
    font_size_diff: 0.5      # å­—å·è¯¯å·®å®¹å¿åº¦ï¼ˆptï¼‰
    color_diff: 5            # é¢œè‰²è¯¯å·®å®¹å¿åº¦ï¼ˆRGBï¼‰
    spacing_diff: 0.1        # é—´è·è¯¯å·®å®¹å¿åº¦ï¼ˆemï¼‰

# ================================
# è¾“å‡ºé…ç½®
# ================================
output:
  format: markdown
  language: zh-CN
  include_diff: true
  include_validation_report: true
  backup_before_modification: false   # ä¸å¤‡ä»½ï¼ˆä¾èµ– Gitï¼‰

# ================================
# å…¼å®¹æ€§é…ç½®
# ================================
compatibility:
  preserve_old_commands: true
  preserve_if_conditions: true
  support_projects:
    - NSFC_Young
    - NSFC_General
    - NSFC_Local
  support_os:
    - windows
    - macos
    - linux
```

---

## ğŸ“¦ README.md å†…å®¹ï¼ˆå¯é€‰ï¼‰

```markdown
# make_latex_model â€” NSFC LaTeX æ¨¡æ¿é«˜ä¿çœŸä¼˜åŒ–å™¨

## ç®€ä»‹

æœ¬æŠ€èƒ½ç”¨äºåŸºäº NSFC æœ€æ–° Word æ¨¡æ¿ï¼ˆå¦‚ 2026 å¹´ç‰ˆï¼‰é«˜ä¿çœŸä¼˜åŒ–ç°æœ‰çš„ LaTeX æ¨¡æ¿ï¼Œç¡®ä¿æ¸²æŸ“çš„ PDF ä¸ Word ç‰ˆæ‰“å°çš„ PDF åœ¨æ ‡é¢˜æ ·å¼ä¸Šå®Œå…¨ä¸€è‡´ã€‚

## ä½¿ç”¨åœºæ™¯

- NSFC å‘å¸ƒäº†æ–°çš„å¹´åº¦ Word æ¨¡æ¿
- å½“å‰ LaTeX æ¨¡æ¿ä¸ Word æ¨¡æ¿å­˜åœ¨æ ·å¼å·®å¼‚
- éœ€è¦å¯¹é½æœ€æ–°æ ¼å¼è¦æ±‚

## æ ¸å¿ƒç‰¹æ€§

âœ… **è½»é‡çº§ä¿®æ”¹**ï¼šä¼˜å…ˆè°ƒæ•´å‚æ•°ï¼Œä¸é‡æ„ç»“æ„
âœ… **è·¨å¹³å°å…¼å®¹**ï¼šæ”¯æŒ Windows/macOS/Linux
âœ… **é«˜ä¿çœŸåº¦**ï¼šç¡®ä¿ä¸ Word æ¨¡æ¿æ ·å¼ä¸€è‡´
âœ… **å¯å›é€€**ï¼šä¾èµ– Git ç‰ˆæœ¬æ§åˆ¶ï¼Œéšæ—¶å¯å›é€€

## ç¤ºä¾‹è°ƒç”¨

```
è¯·ä½¿ç”¨ make_latex_model ä¼˜åŒ– NSFC_Young é¡¹ç›®çš„æ¨¡æ¿ï¼ŒåŸºäº 2026 å¹´ Word æ¨¡æ¿ï¼Œä½¿ç”¨ moderate çº§åˆ«ã€‚
```

## å¼€å‘è¯´æ˜

- æœ¬æŠ€èƒ½éµå®ˆ `/Users/bensz/Nutstore Files/PythonCloud/Agents/pipelines/skills` è§„èŒƒ
- é…ç½®æ–‡ä»¶ï¼š`config.yaml`
- æŠ€èƒ½æ–‡æ¡£ï¼š`SKILL.md`
- å®‰è£…æ–¹å¼ï¼šè¿è¡Œ `install-bensz-skills` ç³»ç»Ÿçº§å®‰è£…å™¨
```

---

## ğŸ¯ å¼€å‘é‡Œç¨‹ç¢‘

| é˜¶æ®µ | ä»»åŠ¡ | äº¤ä»˜ç‰© | çŠ¶æ€ |
|------|------|--------|------|
| **é˜¶æ®µ 1** | åˆ›å»ºæŠ€èƒ½ç›®å½•ç»“æ„ | `skills/make_latex_model/` åŠå¿…éœ€æ–‡ä»¶ | â³ å¾…å¼€å§‹ |
| **é˜¶æ®µ 2** | ç¼–å†™ SKILL.md å’Œ config.yaml | å®Œæ•´çš„æŠ€èƒ½æ–‡æ¡£å’Œé…ç½® | â³ å¾…å¼€å§‹ |
| **é˜¶æ®µ 3** | æµ‹è¯•åŸºç¡€åŠŸèƒ½ | ä½¿ç”¨ 2026 å¹´æ¨¡æ¿æµ‹è¯• NSFC_Young é¡¹ç›® | â³ å¾…å¼€å§‹ |
| **é˜¶æ®µ 4** | ä¼˜åŒ–ä¸è¿­ä»£ | æ ¹æ®æµ‹è¯•ç»“æœè°ƒæ•´æŠ€èƒ½é…ç½® | â³ å¾…å¼€å§‹ |
| **é˜¶æ®µ 5** | æ–‡æ¡£å®Œå–„ | README.mdã€CHANGELOG.md | â³ å¾…å¼€å§‹ |

---

## âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹

### 1. è½»é‡çº§ä¿®æ”¹åŸåˆ™
- âœ… è°ƒæ•´å‚æ•°å€¼ï¼ˆå­—å· pt å€¼ã€é¢œè‰² RGB å€¼ã€é—´è· em/cm å€¼ï¼‰
- âœ… æ–°å¢è‡ªå®šä¹‰å‘½ä»¤
- âŒ åˆ é™¤æˆ–é‡å‘½åç°æœ‰å‘½ä»¤
- âŒ æ”¹å˜å®åŒ…åŠ è½½é¡ºåº
- âŒ é‡æ„æ¡ä»¶åˆ¤æ–­ç»“æ„

### 2. ä¿çœŸåº¦ä¸ç¨³å®šæ€§å¹³è¡¡
- **è¿‡åº¦å¼€å‘çš„é£é™©**ï¼šå¼•å…¥ bugã€ç ´åå·²æœ‰åŠŸèƒ½ã€å¢åŠ ç»´æŠ¤æˆæœ¬
- **å¼€å‘ä¸è¶³çš„é£é™©**ï¼šæ ·å¼ä¸ä¸€è‡´ã€ä¸ç¬¦åˆåŸºé‡‘å§”è¦æ±‚
- **å¹³è¡¡ç­–ç•¥**ï¼š
  - é»˜è®¤ä½¿ç”¨ `moderate` çº§åˆ«
  - ä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨ `thorough` çº§åˆ«
  - ä¿ç•™è€æ ·å¼çš„æ ¸å¿ƒæ¶æ„

### 3. è·¨å¹³å°å…¼å®¹æ€§
- ä¿ç•™ `\ifwindows` æ¡ä»¶åˆ¤æ–­
- ç¡®ä¿ Mac/Windows/Linux éƒ½èƒ½æ­£ç¡®ç¼–è¯‘
- å¤–æŒ‚å­—ä½“è·¯å¾„ä¿æŒä¸å˜ï¼ˆ`./fonts/`ï¼‰

### 4. å‘åå…¼å®¹
- ç¡®ä¿è€ç”¨æˆ·çš„å†…å®¹æ–‡ä»¶æ— éœ€ä¿®æ”¹
- ä¸æ”¹å˜å†…å®¹æ–‡ä»¶çš„æ¥å£
- ä»…ä¿®æ”¹æ ·å¼å®šä¹‰å±‚

### 5. Git å‹å¥½
- ä¸å¤‡ä»½æ—§æ–‡ä»¶
- ä¾èµ– Git ç‰ˆæœ¬æ§åˆ¶
- å¯éšæ—¶å›é€€

---

## ğŸ“‹ å®¡æŸ¥è¦ç‚¹

è¯·æ‚¨é‡ç‚¹å®¡æŸ¥ä»¥ä¸‹æ–¹é¢ï¼š

1. **âœ… æŠ€èƒ½å®šä½æ˜¯å¦æ¸…æ™°**ï¼šæ˜¯å¦æ˜ç¡®äº†"é«˜ä¿çœŸä¼˜åŒ–"è€Œé"é‡æ„"
2. **âœ… ä¿®æ”¹åŸåˆ™æ˜¯å¦åˆç†**ï¼šè½»é‡çº§ã€å¢é‡å¼ã€ä¿ç•™è€æ¶æ„
3. **âœ… Word æ¨¡æ¿å¤„ç†ç­–ç•¥æ˜¯å¦å¯è¡Œ**ï¼šäºŒè¿›åˆ¶æ ¼å¼çš„æ ·å¼æå–æ–¹æ¡ˆ
4. **âœ… optimization_level è®¾è®¡æ˜¯å¦åˆç†**ï¼šminimal/moderate/thorough ä¸‰çº§æ˜¯å¦è¶³å¤Ÿ
5. **âœ… éªŒè¯æ¸…å•æ˜¯å¦å®Œæ•´**ï¼šæ˜¯å¦è¦†ç›–äº†å…³é”®çš„æ ·å¼è¦ç´ 
6. **âœ… é…ç½®æ–‡ä»¶æ˜¯å¦è¿‡åº¦å¤æ‚**ï¼šconfig.yaml æ˜¯å¦éœ€è¦ç®€åŒ–
7. **âœ… æ˜¯å¦ç¬¦åˆ Nutstore skills è§„èŒƒ**ï¼šYAML frontmatterã€ç›®å½•ç»“æ„ç­‰

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [é¡¹ç›® CLAUDE.md](../CLAUDE.md)
- [skills/README.md](../skills/README.md)
- [ç°æœ‰ main.tex](../projects/NSFC_Young/main.tex)
- [ç°æœ‰ @config.tex](../projects/NSFC_Young/extraTex/@config.tex)
- [Nutstore skills è§„èŒƒ](/Users/bensz/Nutstore%20Files/PythonCloud/Agents/pipelines/skills/install-bensz-skills/README.md)

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0.0
**æœ€åæ›´æ–°**ï¼š2026-01-05 17:48
