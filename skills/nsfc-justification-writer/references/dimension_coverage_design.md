# 内容维度覆盖检查：设计说明

本文件说明 `内容维度覆盖检查` 的设计目的、检查维度、输出格式与回退策略，便于维护与自定义。

## 设计目的

- 避免“只改标题不补内容”的结构性空洞：标题存在但叙事闭环缺失
- 降低对标题用词的依赖：允许用户改写 `\\subsubsection` 标题，但仍能检查内容是否覆盖关键叙事维度
- 给出可执行的“缺什么补什么”建议，支持渐进式写作

## 四个维度定义（叙事闭环）

1) **价值与必要性**
   - 回答：为什么要做、痛点是什么、影响范围/成本/迫切性
2) **现状与不足**
   - 回答：主流路线/代表性工作是什么、局限性是什么、瓶颈在哪里
3) **科学问题/假说**
   - 回答：核心假说是什么、关键科学问题是什么、如何可验证/可证伪
4) **项目切入点**
   - 回答：本项目相对现有工作的差异化切口是什么、准备怎么做、如何验证

## 输出 JSON（契约）

`scripts/core/dimension_coverage.py` 输出结构：

```json
{
  "dimensions": {
    "价值与必要性": {"covered": true, "confidence": 0.95, "evidence": "…"},
    "现状与不足": {"covered": true, "confidence": 0.88, "evidence": "…"},
    "科学问题/假说": {"covered": false, "confidence": 0.40, "evidence": ""},
    "项目切入点": {"covered": true, "confidence": 0.83, "evidence": "…"}
  },
  "missing_dimensions": ["科学问题/假说"],
  "suggestions": ["建议补充核心假说…"],
  "_mode": "ai|fallback"
}
```

字段约束：
- `evidence`：原文片段（不超过 50 字），不得杜撰引用与 DOI
- `confidence`：0–1 之间的置信度（AI 模式由模型给出；fallback 模式为启发式估计）

## 回退策略（fallback）

当 AI 不可用/异常时，使用启发式规则：
- 去注释后文本中匹配“维度信号词”（如“痛点/不足/假说/本项目将…”）
- 若命中则视为 `covered=true`，否则列入 `missing_dimensions`
- `suggestions` 只提供少量、可直接补写的提示语句

该回退策略不追求完美，只用于：
- 防止检查完全失效
- 给写作流程提供方向性提示

## 可配置项

字符截断与输入上限使用 `config.yaml`：
- `limits.ai_max_input_chars`：AI 输入字符上限（同时影响术语一致性、吹牛式表述等语义任务）
